{
  "AWSTemplateFormatVersion":"2010-09-09",
  "Description":"AWS CloudFormation template to create the CloudAdmin IAM Role.",
  "Mappings":{
    "VariablesMap":{
      "CompanyRootAccount":{
        "RootAccountId":"123456789"
      }
    }
  },
  "Resources":{
    "CloudAdminRole":{
      "Type":"AWS::IAM::Role",
      "Properties":{
      	"RoleName":"CloudAdminServiceRole",
        "AssumeRolePolicyDocument":{
          "Version":"2012-10-17",
          "Statement":[
            {
              "Effect":"Allow",
              "Action":"sts:AssumeRole",
              "Principal":{
                "AWS":{"Fn::Join":[":",["arn:aws:iam:",{"Fn::FindInMap":["VariablesMap","CompanyRootAccount","RootAccountId"]},"root"]]}
              }
            }
          ]
        }
      }
    },
    "CloudAdminPolicy":{
      "Type":"AWS::IAM::ManagedPolicy",
      "Properties":{
      	"ManagedPolicyName":"CloudAdminServiceManagedPolicy",
        "Description":"Policy for CloudAdmin Read Permissions",
        "PolicyDocument":{
          "Version":"2012-10-17",
          "Statement":[
            {
              "Effect":"Allow",
              "Action":[
                "aws-portal:ViewBilling",
                "aws-portal:ViewUsage",
                "autoscaling:Describe*",
                "cloudwatch:Describe*",
                "cloudwatch:Get*",
                "cloudwatch:List*",
                "ec2:Describe*",
                "elasticache:Describe*",
                "elasticache:ListTagsForResource",
                "elasticloadbalancing:Describe*",
                "redshift:Describe*",
                "route53:Get*",
                "route53:List*",
                "rds:Describe*",
                "rds:ListTagsForResource",
                "ec2:DescribeAccountAttributes",
                "ec2:DescribeAvailabilityZones",
                "ec2:DescribeInternetGateways",
                "ec2:DescribeSecurityGroups",
                "ec2:DescribeSubnets",
                "ec2:DescribeVpcAttribute",
                "ec2:DescribeVpcs",
                "cloudwatch:GetMetricStatistics",
                "logs:DescribeLogStreams",
                "logs:GetLogEvents",
                "es:DescribeReservedElasticsearchInstanceOfferings",
                "es:ListElasticsearchInstanceTypeDetails",
                "es:ESHttpGet",
                "es:ListTags",
                "es:DescribeElasticsearchDomainConfig",
                "es:GetUpgradeHistory",
                "es:ESCrossClusterGet",
                "es:DescribeInboundCrossClusterSearchConnections",
                "es:DescribeReservedElasticsearchInstances",
                "es:ESHttpHead",
                "es:ListDomainNames",
                "es:DescribeElasticsearchDomain",
                "es:GetCompatibleElasticsearchVersions",
                "es:GetUpgradeStatus",
                "es:DescribeElasticsearchDomains",
                "es:ListElasticsearchInstanceTypes",
                "es:DescribeOutboundCrossClusterSearchConnections",
                "es:ListElasticsearchVersions",
                "es:DescribeElasticsearchInstanceTypeLimits"
              ],
              "Resource":"*"
            }
          ]
        },
        "Roles":[{
          "Ref":"CloudAdminRole"
        }]
      }
    }
  }
}
